/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={"function":!0,object:!0},c=b[typeof exports]&&exports&&!exports.nodeType&&exports,d=b[typeof self]&&self.Object&&self,e=b[typeof window]&&window&&window.Object&&window,f=b[typeof module]&&module&&!module.nodeType&&module,g=(f&&f.exports===c&&c,c&&f&&"object"==typeof global&&global&&global.Object&&global),h=h=g||e!==(this&&this.window)&&e||d||this;"function"==typeof define&&define.amd?define(["./rx.lite.compat"],function(b,c){return a(h,c,b)}):"object"==typeof module&&module&&module.exports===c?module.exports=a(h,module.exports,require("rx-lite-compat")):h.Rx=a(h,{},h.Rx)}).call(this,function(a,b,c,d){function e(a){return function(){try{return a.apply(this,arguments)}catch(b){return B.e=b,B}}}function f(a){return a.toArray()}function g(a,b){return a.groupJoin(this,b,s,function(a,b){return b})}function h(a){var b=this;return new u(function(c){var d=new q,e=new l,f=new n(e);return c.onNext(v(d,f)),e.add(b.subscribe(function(a){d.onNext(a)},function(a){d.onError(a),c.onError(a)},function(){d.onCompleted(),c.onCompleted()})),y(a)&&(a=A(a)),e.add(a.subscribe(function(a){d.onCompleted(),d=new q,c.onNext(v(d,f))},function(a){d.onError(a),c.onError(a)},function(){d.onCompleted(),c.onCompleted()})),f},b)}function i(a){var b=this;return new u(function(c){function d(){var b;try{b=a()}catch(f){return void c.onError(f)}y(b)&&(b=A(b));var i=new o;e.setDisposable(i),i.setDisposable(b.take(1).subscribe(x,function(a){h.onError(a),c.onError(a)},function(){h.onCompleted(),h=new q,c.onNext(v(h,g)),d()}))}var e=new p,f=new l(e),g=new n(f),h=new q;return c.onNext(v(h,g)),f.add(b.subscribe(function(a){h.onNext(a)},function(a){h.onError(a),c.onError(a)},function(){h.onCompleted(),c.onCompleted()})),d(),g},b)}var j=c.Observable,k=c.ObservableBase,l=c.CompositeDisposable,m=c.BinaryDisposable,n=c.RefCountDisposable,o=c.SingleAssignmentDisposable,p=c.SerialDisposable,q=c.Subject,r=j.prototype,s=j.empty,t=j.never,u=c.AnonymousObservable,v=c.internals.addRef,w=c.internals.inherits,x=c.helpers.noop,y=c.helpers.isPromise,z=c.helpers.isFunction,A=j.fromPromise,B={e:{}},C=c.internals.tryCatch=function(a){if(!z(a))throw new TypeError("fn must be a function");return e(a)},D=a.Map||function(){function a(){this.size=0,this._values=[],this._keys=[]}return a.prototype["delete"]=function(a){var b=this._keys.indexOf(a);return-1===b?!1:(this._values.splice(b,1),this._keys.splice(b,1),this.size--,!0)},a.prototype.get=function(a){var b=this._keys.indexOf(a);return-1===b?d:this._values[b]},a.prototype.set=function(a,b){var c=this._keys.indexOf(a);return-1===c?(this._keys.push(a),this._values.push(b),this.size++):this._values[c]=b,this},a.prototype.forEach=function(a,b){for(var c=0;c<this.size;c++)a.call(b,this._values[c],this._keys[c])},a}();r.join=function(a,b,c,d){var e=this;return new u(function(f){var g=new l,h=!1,i=!1,j=0,k=0,m=new D,n=new D,p=function(a){f.onError(a)};return g.add(e.subscribe(function(a){var c=j++,e=new o;m.set(c,a),g.add(e);var i=C(b)(a);return i===B?f.onError(i.e):(e.setDisposable(i.take(1).subscribe(x,p,function(){m["delete"](c)&&0===m.size&&h&&f.onCompleted(),g.remove(e)})),void n.forEach(function(b){var c=C(d)(a,b);return c===B?f.onError(c.e):void f.onNext(c)}))},p,function(){h=!0,(i||0===m.size)&&f.onCompleted()})),g.add(a.subscribe(function(a){var b=k++,e=new o;n.set(b,a),g.add(e);var h=C(c)(a);return h===B?f.onError(h.e):(e.setDisposable(h.take(1).subscribe(x,p,function(){n["delete"](b)&&0===n.size&&i&&f.onCompleted(),g.remove(e)})),void m.forEach(function(b){var c=C(d)(b,a);return c===B?f.onError(c.e):void f.onNext(c)}))},p,function(){i=!0,(h||0===n.size)&&f.onCompleted()})),g},e)},r.groupJoin=function(a,b,c,d){var e=this;return new u(function(f){function g(a){}var h=new l,i=new n(h),j=new D,k=new D,m=0,p=0,g=function(a){return function(b){b.onError(a)}};return h.add(e.subscribe(function(a){var c=new q,e=m++;j.set(e,c);var l=C(d)(a,v(c,i));if(l===B)return j.forEach(g(l.e)),f.onError(l.e);f.onNext(l),k.forEach(function(a){c.onNext(a)});var n=new o;h.add(n);var p=C(b)(a);return p===B?(j.forEach(g(p.e)),f.onError(p.e)):void n.setDisposable(p.take(1).subscribe(x,function(a){j.forEach(g(a)),f.onError(a)},function(){j["delete"](e)&&c.onCompleted(),h.remove(n)}))},function(a){j.forEach(g(a)),f.onError(a)},function(){f.onCompleted()})),h.add(a.subscribe(function(a){var b=p++;k.set(b,a);var d=new o;h.add(d);var e=C(c)(a);return e===B?(j.forEach(g(e.e)),f.onError(e.e)):(d.setDisposable(e.take(1).subscribe(x,function(a){j.forEach(g(a)),f.onError(a)},function(){k["delete"](b),h.remove(d)})),void j.forEach(function(b){b.onNext(a)}))},function(a){j.forEach(g(a)),f.onError(a)})),i},e)},r.buffer=function(){return this.window.apply(this,arguments).flatMap(f)},r.window=function(a,b){return 1===arguments.length&&"function"!=typeof arguments[0]?h.call(this,a):"function"==typeof a?i.call(this,a):g.call(this,a,b)},r.pairwise=function(){var a=this;return new u(function(b){var c,d=!1;return a.subscribe(function(a){d?b.onNext([c,a]):d=!0,c=a},b.onError.bind(b),b.onCompleted.bind(b))},a)},r.partition=function(a,b){return[this.filter(a,b),this.filter(function(c,d,e){return!a.call(b,c,d,e)})]},r.groupBy=function(a,b){return this.groupByUntil(a,b,t)},r.groupByUntil=function(a,b,c){var e=this;return new u(function(f){var g=new D,h=new l,i=new n(h),j=function(a){return function(b){b.onError(a)}};return h.add(e.subscribe(function(e){var k=C(a)(e);if(k===B)return g.forEach(j(k.e)),f.onError(k.e);var l=!1,m=g.get(k);if(m===d&&(m=new q,g.set(k,m),l=!0),l){var n=new F(k,m,i),p=new F(k,m),r=C(c)(p);if(r===B)return g.forEach(j(r.e)),f.onError(r.e);f.onNext(n);var s=new o;h.add(s),s.setDisposable(r.take(1).subscribe(x,function(a){g.forEach(j(a)),f.onError(a)},function(){g["delete"](k)&&m.onCompleted(),h.remove(s)}))}var t=e;return z(b)&&(t=C(b)(e),t===B)?(g.forEach(j(t.e)),f.onError(t.e)):void m.onNext(t)},function(a){g.forEach(j(a)),f.onError(a)},function(){g.forEach(function(a){a.onCompleted()}),f.onCompleted()})),i},e)};var E=function(a){function b(b,c){this._m=b,this._u=c,a.call(this)}return w(b,a),b.prototype.subscribeCore=function(a){return new m(this._m.getDisposable(),this._u.subscribe(a))},b}(k),F=function(a){function b(b,c,d){a.call(this),this.key=b,this.underlyingObservable=d?new E(d,c):c}return w(b,a),b.prototype._subscribe=function(a){return this.underlyingObservable.subscribe(a)},b}(j);return c});
//# sourceMappingURL=rx.lite.coincidence.compat.map